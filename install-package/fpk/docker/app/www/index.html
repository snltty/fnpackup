<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        .wrap{
            
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            text-align: center;
        }
        .msg{
            color:red;
        }
        .be-danger{ 
            color: #ff8d00;
        }
        .to-danger{
            color: blue;
        }
    </style>
</head>
<body>
    <div class="wrap">
        <p class="msg">未能信任自签证书,请手动无视风险</p>
        <a href="" target="_blank" class="be-danger">去无视风险</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:;" class="to-danger" onclick="window.location.reload()">已无视风险</a>
    </div>

    <script>
        const theme = {
            '10':'light',
            '20':'dark'
        }[localStorage.getItem('fnos-theme-mode')] || '';
        const cookies = document.cookie.split(' ').map(c=>c.split('=')).reduce((json,item)=>{
            json[item[0]] = item.filter((c,i)=>i>0).join('=');
            return json;
        },{});

        const port = window.location.protocol == 'http:' ? '1069' : '10699'
        let newUrl = `${window.location.protocol}//${window.location.hostname}:${port}`;
        if(window.location.hostname.endsWith('fnos.net')){
            newUrl = `${window.location.protocol}//fnpackup-docker.${window.location.hostname}`
        }
        newUrl = `${newUrl}/#/?fnos-theme=${theme}&fnos-token=${encodeURIComponent(cookies['fnos-token'])}`;
        document.querySelector('.be-danger').href = newUrl;
        fetch(newUrl).then(res=>{
            window.location = `${newUrl}/#/?fnos-theme=${theme}&fnos-token=${encodeURIComponent(cookies['fnos-token'])}`;
        })
    </script>
</body>
</html>